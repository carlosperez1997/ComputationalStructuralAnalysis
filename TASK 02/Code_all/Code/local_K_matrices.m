% Axial stress in x-direction (bars)
K = E*A/L*[
    1,    -1;
   -1,     1;
];
% Shear stress in y-direction and bending moment in z-direction (beam)
K = 2*E*Iz/L^3*[
    6,   3*L,    -6,   3*L;
  3*L, 2*L^2,  -3*L,   L^2;
   -6,  -3*L,     6,  -3*L; 
  3*L,   L^2,  -3*L, 2*L^2;
];
% Shear stress in z-direction and bending moment in y-direction (beam)
K = 2*E*Iy/L^3*[
    6,  -3*L,    -6,  -3*L;
 -3*L, 2*L^2,   3*L,   L^2;
   -6,   3*L,     6,   3*L; 
 -3*L,   L^2,   3*L, 2*L^2;
];
% Torsion moment in x-direction
K = E*J/(2*(1+nu)*L)*[
    1,    -1;
   -1,     1;
];
% In-plane stress in x and y-directions (rectangular membrane)
K = ...
E*b*h/(12*a*(1-nu^2))*[
    4,         0, -4,         0, -2,         0,  2,         0;
    0,  2*(1-nu),  0, -2*(1-nu),  0,   -(1-nu),  0,      1-nu;
   -4,         0,  4,         0,  2,         0, -2,         0;
    0, -2*(1-nu),  0,  2*(1-nu),  0,      1-nu,  0,   -(1-nu);
   -2,         0,  2,         0,  4,         0, -4,         0;
    0,   -(1-nu),  0,      1-nu,  0,  2*(1-nu),  0, -2*(1-nu);
    2,         0, -2,         0, -4,         0,  4,         0;
    0,      1-nu,  0,   -(1-nu),  0, -2*(1-nu),  0,  2*(1-nu);
] + ...
E*a*h/(12*b*(1-nu^2))*[
    2*(1-nu),  0,      1-nu,  0,   -(1-nu),  0, -2*(1-nu),  0;
           0,  4,         0,  2,         0, -2,         0, -4;
        1-nu,  0,  2*(1-nu),  0, -2*(1-nu),  0,   -(1-nu),  0;
           0,  2,         0,  4,         0, -4,         0, -2;
     -(1-nu),  0, -2*(1-nu),  0,  2*(1-nu),  0,      1-nu,  0;
           0, -2,         0, -4,         0,  4,         0,  2;
   -2*(1-nu),  0,   -(1-nu),  0,      1-nu,  0,  2*(1-nu),  0;
           0, -4,         0, -2,         0,  2,         0,  4;
] + ...
E*h/(8*(1-nu^2))*[
           0,      1+nu,         0, -(1-3*nu),         0,   -(1+nu),         0,    1-3*nu;
        1+nu,         0,    1-3*nu,         0,   -(1+nu),         0, -(1-3*nu),         0;
           0,    1-3*nu,         0,   -(1+nu),         0, -(1-3*nu),         0,      1+nu;
   -(1-3*nu),         0,   -(1+nu),         0,    1-3*nu,         0,      1+nu,         0;
           0,   -(1+nu),         0,    1-3*nu,         0,      1+nu,         0, -(1-3*nu);
     -(1+nu),         0, -(1-3*nu),         0,      1+nu,         0,    1-3*nu,         0;
           0, -(1-3*nu),         0,      1+nu,         0,    1-3*nu,         0,   -(1+nu);
      1-3*nu,         0,      1+nu,         0, -(1-3*nu),         0,   -(1+nu),         0;
];
% Out-of-plane stress in z-direction and in-plane bending moment in x and y-directions (rectangular plate)
K = ...
E*a*h^3/(72*b^3*(1-nu^2))*[
         6,  0,    6*b,    3,  0,    3*b,   -3,  0,    3*b,   -6,  0,    6*b;
         0,  0,      0,    0,  0,      0,    0,  0,      0,    0,  0,      0;
       6*b,  0,  8*b^2,  3*b,  0,  4*b^2, -3*b,  0,  2*b^2, -6*b,  0,  4*b^2;
         3,  0,    3*b,    6,  0,    6*b,   -6,  0,    6*b,   -3,  0,    3*b;
         0,  0,      0,    0,  0,      0,    0,  0,      0,    0,  0,      0;
       3*b,  0,  4*b^2,  6*b,  0,  8*b^2, -6*b,  0,  4*b^2, -3*b,  0,  2*b^2;
        -3,  0,   -3*b,   -6,  0,   -6*b,    6,  0,   -6*b,    3,  0,   -3*b;
         0,  0,      0,    0,  0,      0,    0,  0,      0,    0,  0,      0;
       3*b,  0,  2*b^2,  6*b,  0,  4*b^2, -6*b,  0,  8*b^2, -3*b,  0,  4*b^2;
        -6,  0,   -6*b,   -3,  0,   -3*b,    3,  0,   -3*b,    6,  0,   -6*b;
         0,  0,      0,    0,  0,      0,    0,  0,      0,    0,  0,      0;
       6*b,  0,  4*b^2,  3*b,  0,  2*b^2, -3*b,  0,  4*b^2, -6*b,  0,  8*b^2;
] + ...
E*b*h^3/(72*a^3*(1-nu^2))*[
         6,    6*a,  0,   -6,    6*a,  0,   -3,    3*a,  0,    3,    3*a,  0;
       6*a,  8*a^2,  0, -6*a,  4*a^2,  0, -3*a,  2*a^2,  0,  3*a,  4*a^2,  0;
         0,      0,  0,    0,      0,  0,    0,      0,  0,    0,      0,  0;
        -6,   -6*a,  0,    6,   -6*a,  0,    3,   -3*a,  0,   -3,   -3*a,  0;
       6*a,  4*a^2,  0, -6*a,  8*a^2,  0, -3*a,  4*a^2,  0,  3*a,  2*a^2,  0;
         0,      0,  0,    0,      0,  0,    0,      0,  0,    0,      0,  0;
        -3,   -3*a,  0,    3,   -3*a,  0,    6,   -6*a,  0,   -6,   -6*a,  0;
       3*a,  2*a^2,  0, -3*a,  4*a^2,  0, -6*a,  8*a^2,  0,  6*a,  4*a^2,  0;
         0,      0,  0,    0,      0,  0,    0,      0,  0,    0,      0,  0;
         3,    3*a,  0,   -3,    3*a,  0,   -6,    6*a,  0,    6,    6*a,  0;
       3*a,  4*a^2,  0, -3*a,  2*a^2,  0, -6*a,  4*a^2,  0,  6*a,  8*a^2,  0;
         0,      0,  0,    0,      0,  0,    0,      0,  0,    0,      0,  0;
] + ...
E*nu*h^3/(24*a*b*(1-nu^2))*[
         1,      a,      b, -1,      0,     -b,  1,      0,      0, -1,     -a,      0;
         a,      0,  2*b*a,  0,      0,      0,  0,      0,      0, -a,      0,      0;
         b,  2*a*b,      0, -b,      0,      0,  0,      0,      0,  0,      0,      0;
        -1,      0,     -b,  1,     -a,      b, -1,      a,      0,  1,      0,      0;
         0,      0,      0, -a,      0, -2*b*a,  a,      0,      0,  0,      0,      0;
        -b,      0,      0,  b, -2*a*b,      0,  0,      0,      0,  0,      0,      0;
         1,      0,      0, -1,      a,      0,  1,     -a,     -b, -1,      0,      b;
         0,      0,      0,  a,      0,      0, -a,      0,  2*b*a,  0,      0,      0;
         0,      0,      0,  0,      0,      0, -b,  2*a*b,      0,  b,      0,      0;
        -1,     -a,      0,  1,      0,      0, -1,      0,      b,  1,      a,     -b;
        -a,      0,      0,  0,      0,      0,  0,      0,      0,  a,      0, -2*b*a;
         0,      0,      0,  0,      0,      0,  b,      0,      0, -b, -2*a*b,      0;
] + ...
E*h^3/(360*a*b*(1+nu))*[
        21,    3*a,    3*b,  -21,    3*a,   -3*b,   21,   -3*a,   -3*b,  -21,   -3*a,    3*b;
       3*a,  8*a^2,      0, -3*a, -2*a^2,      0,  3*a,  2*a^2,      0, -3*a, -8*a^2,      0;
       3*b,      0,  8*b^2, -3*b,      0, -8*b^2,  3*b,      0,  2*b^2, -3*b,      0, -2*b^2;
       -21,   -3*a,   -3*b,   21,   -3*a,    3*b,  -21,    3*a,    3*b,   21,    3*a,   -3*b;
       3*a, -2*a^2,      0, -3*a,  8*a^2,      0,  3*a, -8*a^2,      0, -3*a,  2*a^2,      0;
      -3*b,      0, -8*b^2,  3*b,      0,  8*b^2, -3*b,      0, -2*b^2,  3*b,      0,  2*b^2;
        21,    3*a,    3*b,  -21,    3*a,   -3*b,   21,   -3*a,   -3*b,  -21,   -3*a,    3*b;
      -3*a,  2*a^2,      0,  3*a, -8*a^2,      0, -3*a,  8*a^2,      0,  3*a, -2*a^2,      0;
      -3*b,      0,  2*b^2,  3*b,      0, -2*b^2, -3*b,      0,  8*b^2,  3*b,      0, -8*b^2;
       -21,   -3*a,   -3*b,   21,   -3*a,    3*b,  -21,    3*a,    3*b,   21,    3*a,   -3*b;
      -3*a, -8*a^2,      0,  3*a,  2*a^2,      0, -3*a, -2*a^2,      0,  3*a,  8*a^2,      0;
       3*b,      0, -2*b^2, -3*b,      0,  2*b^2,  3*b,      0, -8*b^2, -3*b,      0,  8*b^2;
];
% Torsion moment in z-direction (rectangular plate)
K = 4*a*b*E*[
   1,  0,  0,  0;
   0,  1,  0,  0;
   0,  0,  1,  0;
   0,  0,  0,  1; 
];